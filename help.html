<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EPS Matrix â€“ Aide</title>
  <script>
    (function(){
      try{
        const stored = localStorage.getItem('eps.matrix.theme');
        if(stored){ document.documentElement.dataset.theme = stored; }
      }catch(_e){}
    })();
  </script>
  <link rel="stylesheet" href="styles.css" />
  <script defer src="theme.js"></script>
</head>
<body>
  <button class="themeToggle" id="themeToggle" aria-label="Mode nuit">ğŸŒ™</button>
  <main class="card-full" style="gap:24px;max-width:960px;">
    <header class="app">
      <div>
        <h2>Aide & modes d'emploi</h2>
        <p class="dragHint">Version du <span id="helpDate"></span></p>
      </div>
      <div class="navButtons">
        <a class="btn secondary" href="hub.html">â† Retour hub</a>
        <a class="btn secondary" href="evaluation.html" target="_blank" rel="noopener">Ouvrir une Ã©valuation</a>
      </div>
    </header>

    <section class="manualBlock" data-tone="blue">
      <h3>Sauvegarder ou rÃ©cupÃ©rer ses donnÃ©es</h3>
      <ul>
        <li><strong>Archive dâ€™Ã©valuation (.epsarchive.json)</strong> : exporte une seule Ã©valuation (critÃ¨res + notes). Ã€ rÃ©importer depuis â€œImporter un archivageâ€ dans une classe.</li>
        <li><strong>Sauvegarde complÃ¨te (.epsbackup.json)</strong> : capture toute lâ€™app (â€œSauvegarder mes classesâ€) ou une classe (â€œSauvegarder la classeâ€). Fichier structurÃ© avec <code>kind</code> = <em>epsmatrix.appBackup</em> ou <em>epsmatrix.classBackup</em>.</li>
        <li><strong>Import non destructif</strong> : restaurer ajoute ou duplique (classe suffixÃ©e â€œ(restaurÃ©e AAAA-MM-JJ)â€, Ã©valuations clonÃ©es si lâ€™ID existe). Rien nâ€™est Ã©crasÃ© automatiquement.</li>
        <li><strong>Workflow iPad Fichiers</strong> : exporter, dÃ©poser dans Fichiers, renommer si besoin. Pour restaurer, â€œRÃ©cupÃ©rer une sauvegardeâ€ puis choisir le fichier. Tu peux vider le cache navigateur aprÃ¨s avoir mis tes sauvegardes de cÃ´tÃ©.</li>
        <li><strong>Rapports</strong> : chaque import affiche combien de classes/Ã©valuations ont Ã©tÃ© ajoutÃ©es, dupliquÃ©es ou ignorÃ©es (format incompatible).</li>
      </ul>
    </section>

    <section class="manualBlock" data-tone="green">
      <h3>Archivage des Ã©valuations</h3>
      <ul>
        <li>Cliquer sur â€œArchiverâ€ masque simplement lâ€™Ã©valuation (statut = archivÃ©es). Les donnÃ©es restent dans la classe.</li>
        <li>Les listes affichent une section â€œArchivÃ©esâ€ dans la classe : tu peux ouvrir, dÃ©sarchiver ou supprimer depuis cette section.</li>
        <li>Exporter/Importer continue de fonctionner mÃªme pour une Ã©valuation archivÃ©e.</li>
      </ul>
    </section>

    <section class="manualBlock" data-tone="orange">
      <h3>ABS / DISP (absent / dispensÃ©)</h3>
      <ul>
        <li>Les badges ABS/DISP sont toujours visibles dans le tableau. Les lignes deviennent gris clair (DISP) ou gris bleutÃ© (ABS) et sont triÃ©es Ã  la fin.</li>
        <li>En mode terrain, ABS et DISP basculent automatiquement dans la carte â€œHors terrainâ€ : ils ne participent plus aux matchs tant que le statut reste actif.</li>
        <li>Lâ€™export CSV ajoute deux colonnes <code>absent</code> et <code>dispense</code> (true/false). Lâ€™import CSV accepte ces colonnes et met Ã  jour les statuts.</li>
      </ul>
    </section>

    <section class="manualBlock" data-tone="pink">
      <h3>Mode terrain (type iDoceo)</h3>
      <ul>
        <li><strong>Activer & initialiser</strong> : bouton â€œMode terrainâ€ dans lâ€™Ã©valuation â†’ choisir le nombre de terrains (1 Ã  8) â†’ â€œInitialiserâ€ rÃ©partit les Ã©lÃ¨ves prÃ©sents (round-robin) et dÃ©finit un arbitre max par terrain.</li>
        <li><strong>Tableau = source de vÃ©ritÃ©</strong> : chaque Ã©lÃ¨ve possÃ¨de <em>Terrain</em> + <em>RÃ´le</em>. Modifier ces champs dans le tableau met instantanÃ©ment Ã  jour les cartes terrains (et inversement).</li>
        <li><strong>Vue globale</strong> : cartes Terrain 1..N avec Arbitre, Joueurs, sections â€œÃ€ affecterâ€ et â€œHors terrain (ABS/DISP)â€. Tap sur une carte â†’ vue dÃ©tail.</li>
        <li><strong>Vue dÃ©tail</strong> : sÃ©lectionner gagnant/perdant, saisir un score libre, valider. Le systÃ¨me applique la rÃ¨gle officielle : le gagnant monte dâ€™un terrain (ou reste sur T1) et devient arbitre, le perdant descend, lâ€™ancien arbitre rejoue sur son terrain, et un seul arbitre par terrain est conservÃ©.</li>
        <li><strong>Notes libres</strong> : bouton ğŸ“ Ã  cÃ´tÃ© de chaque Ã©lÃ¨ve (tableau, cartes et vue dÃ©tail) â†’ modale texte synchronisÃ©e.</li>
        <li><strong>RÃ©sultats</strong> : section dÃ©diÃ©e â€œMode terrain â€“ RÃ©sultatsâ€ avec classement (points 3/1, puis victoires, puis terrain actuel, puis ordre alpha). Export CSV dÃ©diÃ© disponible.</li>
        <li><strong>Exemple</strong> : â€œTournoi badminton 5eâ€ avec 4 terrains / 12 Ã©lÃ¨ves. Lance lâ€™init â†’ terrains T1..T4. AprÃ¨s chaque match, clique sur la carte, sÃ©lectionne gagnant/perdant, indique le score (ex : 21-17) â†’ Valider. AprÃ¨s une dizaine de rotations, ouvre lâ€™onglet RÃ©sultats pour annoncer les finalistes (points et rang affichÃ©s automatiquement).</li>
      </ul>
    </section>

    <section class="manualBlock" data-tone="green">
      <h3>Questions frÃ©quentes</h3>
      <ul>
        <li><strong>Puis-je travailler hors-ligne ?</strong> Oui : tout est en localStorage. Pense simplement Ã  exporter une sauvegarde rÃ©guliÃ¨rement (fichiers .epsbackup.json).</li>
        <li><strong>Et sur iPad + Apple Pencil ?</strong> Le mode stylet est optimisÃ© pour Pencil : plein Ã©cran, gomme, Ã©paisseurs, export PNG et multi-pages.</li>
        <li><strong>Comment partager une grille ?</strong> Export CSV pour un collÃ¨gue, ou archive .epsarchive.json pour une Ã©valuation complÃ¨te.</li>
      </ul>
    </section>
  </main>
  <script>
    const label = new Date().toLocaleDateString('fr-FR',{day:'2-digit',month:'2-digit',year:'numeric'});
    const target = document.getElementById('helpDate');
    if(target){ target.textContent = label; }
  </script>
</body>
</html>
